RNA サンプル設定ファイルについて
==================================

項目は6種類あります．

+-----------------+---------------------------------------------------+
| [fastq]         | FASTQファイルを入力として解析します               |
+-----------------+---------------------------------------------------+
| [bam_tofastq]   | BAMを入力してFASTQファイルに戻してから解析します  |
+-----------------+---------------------------------------------------+
| [bam_import]    | 入力したBAMを再マッピングせずに解析を実行します   |
+-----------------+---------------------------------------------------+
| [fusion]        | 融合遺伝子検出が実行されます                      |
+-----------------+---------------------------------------------------+
| [expression]    | 発現量解析が実行されます                          |
+-----------------+---------------------------------------------------+
| [controlpanel]  | コントロールパネルを定義します                    |
+-----------------+---------------------------------------------------+
| [qc]            | BAMのQuality Controlを出力します                  |
+-----------------+---------------------------------------------------+

| RNA解析では
| [fastq], [bam_tofastq], [bam_import] は入力ファイルの情報を記載します．
| [fusion], [expression], [controlpanel], [qc] には解析するための情報を記載します．
| 
| 各項目と処理の流れについては :doc:`rna_workflow` を参照してください．
| 

 :download:`サンプルはこちら <csv/rna_sample.csv>`

[fastq]の記載方法
^^^^^^^^^^^^^^^^^

| 項目[fastq]には入力FASTQファイルのパスを記載します．
|

.. code-block:: bash

  # {サンプル名},{ペアリードの1つ目のFASTQ},{ペアリードの2つ目のFASTQ} の順にカンマ (,) 区切りで記載してください
  sample1,/home/genomon/sample1_read1.fastq,/home/genomon/sample1_read2.fastq
  sample2,/home/genomon/sample2_read1.fastq,/home/genomon/sample2_read2.fastq
  
[bam_tofastq],[bam_import]の記載方法
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

| 項目[bam_import]には入力BAMファイルのパスを記載します．
|

.. code-block:: bash

  # {サンプル名},{BAMファイルのパス} の順にカンマ (,) 区切りで記載してください
  sample3,/home/genomon/sample3.bam
  
| BAM indexファイル(.bai)がセットで必要です．
| .bamファイルと同じディレクトリに.baiファイルがあることを確認してください．
|

.. note::
  
  **サンプル名について**
  
  | [fastq],[bam_tofastq],[bam_import]では，先頭にサンプルの名前を付けます．
  | サンプル名は1行に一つ指定し，他のサンプルと重複することはできません．
  | このサンプル名はこの後指定するすべての項目（[fusion],[expression] 等）で使用します．
  | サンプル名は任意で指定できますが，ディレクトリや解析結果の出力ファイル名にも使用しますので，ある程度サンプルの特徴をとらえた名前をお勧めします．
  |

[fusion]の記載方法
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

| 項目[fusion] にはサンプルとコントロールパネルを記載します．
| コントロールパネル名は項目[controlpanel]で定義した名前を使用します．（次項で説明します）
|
| {サンプル},{controlpanel} の順にカンマ (,) 区切りで記載してください．
| {controlpanel}がない場合は以下のように記載します．
|

=============== =========================== ===========================================
パターン        コントロールパネル          書き方
=============== =========================== ===========================================
パターン１       ○                          sample1,Panel1
パターン２       ×                          sample2,None
=============== =========================== ===========================================

.. code-block:: bash

  # Tumorサンプル名,Normalサンプル名,コントロールパネル名 と記載してください．

  # パターン１：コントロールパネルがある場合
  # サンプル名,コントロールパネル名 と記載してください．コントロールパネル名は項目[controlpanel]で定義した名前を使用します．
  sample1,Panel1
  
  # パターン２：コントロールパネルがない場合
  # サンプル名,None と記載してください．
  sample2,None
  
| この項目に定義するサンプル名は[fastq], [bam_tofastq], [bam_import]のいずれかで定義されていなくてはなりません．
| 

[controlpanel]の記載方法
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

| 項目[controlpanel]には，Normalサンプル名を複数指定して，コントロールパネル名を付けてNormalサンプルの集まりとして指定します．
|

.. code-block:: bash

  # コントロールパネル名,Normalサンプル1,Normalサンプル2,Normalサンプル3,・・・,NormalサンプルN と記載してください．
  panel1,sample1_normal,sample2_normal,sample3_normal,sample4_normal
  panel2,sample5_normal,sample6_normal,sample7_normal,sample8_normal
  
| 指定するサンプル数Nに最大値はないです．
| サンプル名は[fastq], [bam_tofastq], [bam_import]のいずれかで定義されていなくてはなりません．
| コントロールパネル名は任意で指定できますが，重複することはできません．
| 

.. note::
  
  | **コントロールパネルについて**
  |
  | Genomonではコントロールパネルを用いて，germline変異やエラーの除去を行っています．
  | Normalサンプルのグループ（コントロールパネル）で変異を含むリードが複数見つかれば，germline変異やエラーとして除外することができます．
  | そのため，可能な限りコントロールパネルをご使用いただくことを推奨しています．
  |


[expression], [qc]の記載方法
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

| 項目[expression], [qc] にはサンプル名を記載します．
|

.. code-block:: bash

  # ペアで記載する必要はありません．QC出力するサンプル名を記載してください．記載順も関係ありません．
  sample1
  sample2
  sample3


| この項目に定義するサンプル名は[fastq], [bam_tofastq], [bam_import]のいずれかで定義されていなくてはなりません．
| 

